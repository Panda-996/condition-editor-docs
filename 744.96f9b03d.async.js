(self.webpackChunkcondition_editor=self.webpackChunkcondition_editor||[]).push([[744],{76643:function(F,x,n){"use strict";n.d(x,{n:function(){return Kn}});var j=n(26068),d=n.n(j),P=n(90228),i=n.n(P),D=n(87999),$=n.n(D),A=n(48305),H=n.n(A),L=n(67825),J=n.n(L),_=n(6085);function ln(S,a){var Z=S;for(var o in a)a.hasOwnProperty(o)&&(Z[o]=a[o]);return Z}var T=n(1787),z=n(48763),W=n(68106),w=n(14413),on=n(11550),en=n(17180),k=n(23136),gn=n(56354),Q=n(59496),En=n(42726),xn=n(82092),An=n.n(xn),fn=n(9983),hn=n(59778),On=n(82187),jn=n.n(On),Cn=n(93084),Dn=n(24869),yn=n(91492),l=n(87039),u=n(4637),Bn=function(a){var Z,o=(0,z.t)("condition-item"),an=(0,Q.useState)(!1),Y=H()(an,2),dn=Y[0],e=Y[1],G=(0,Q.useRef)(),t=(0,fn.E)(),V=(Z=t==null?void 0:t.disabled)!==null&&Z!==void 0?Z:!1,y=(t==null?void 0:t.levelText)||[],g=a.value,rn=a.onChange,X=a.actionRef,K=function(s){var f=(0,T.p)(g);return f.data=s,rn(f)},R=function(){return(0,W.m)(t==null?void 0:t.renderCondField)?t.renderCondField({node:g,data:(0,T.p)(g.data),disabled:V},K,t.getContainer):(0,u.jsx)("div",{children:"-"})},p=(0,Q.useMemo)(function(){var r;return(r=t==null?void 0:t.operators)!==null&&r!==void 0?r:[]},[t==null?void 0:t.operators]),m=function(){var s;return(0,W.m)(t==null?void 0:t.renderCondOperator)?t.renderCondOperator({node:g,data:(0,T.p)(g.data),disabled:V},K,t.getContainer):(0,u.jsx)(hn.Z,{getPopupContainer:t==null?void 0:t.getContainer,placeholder:"\u8BF7\u9009\u62E9",dropdownMatchSelectWidth:!1,value:(s=g.data)===null||s===void 0?void 0:s.operator,onChange:function(N){var h=(0,T.p)(g.data);rn(d()(d()({},h),{},{operator:N}))},style:{minWidth:"80px",width:"100%",maxWidth:"100%"},options:p})},E=function(){var s;return(0,W.m)(t==null?void 0:t.renderCondValue)?t.renderCondValue({node:g,data:(0,T.p)(g.data),disabled:V},K,t.getContainer):(0,u.jsx)(Dn.Z,{style:{width:"120px"},placeholder:"\u8BF7\u8F93\u5165",value:(s=g.data)===null||s===void 0?void 0:s.value,onChange:function(N){var h,U,q=N==null||(h=N.target)===null||h===void 0?void 0:h.value;return K(d()(d()({},(U=g.data)!==null&&U!==void 0?U:{}),{},{value:q}))}})},B=function(){return(0,W.m)(t==null?void 0:t.renderCondPrefix)?t.renderCondPrefix({node:g,data:(0,T.p)(g.data),disabled:V},K,t.getContainer):null},c=function(){return(0,W.m)(t==null?void 0:t.renderCondExtra)?t.renderCondExtra({node:g,data:(0,T.p)(g.data),disabled:V},K,t.getContainer):null};(0,Q.useEffect)(function(){(0,W.m)(X)&&G.current&&X(G.current)},[X]);var v={add:function(s,f){var N;a==null||(N=a.onAdd)===null||N===void 0||N.call(a,g.key,s,f)},delete:function(){var s;a==null||(s=a.onDelete)===null||s===void 0||s.call(a,g.key)}};G.current=v,X&&(X.current=G.current);var I=function(){if(V)return null;var s=(0,u.jsx)("div",{className:"".concat(o,"-action ").concat(o,"-action-delete"),onClick:function(C){var O;C==null||(O=C.stopPropagation)===null||O===void 0||O.call(C),v.delete()},children:(0,u.jsx)(Cn.p,{})},"delete"),f=(0,u.jsx)(k.Z,{type:"link",block:!0,onClick:function(C){var O;C==null||(O=C.stopPropagation)===null||O===void 0||O.call(C),e(!1),v.add(l.s9.Before)},children:y[0]||"\u5728\u4E0A\u65B9\u63D2\u5165\u6761\u4EF6"},l.s9.Before),N=(0,u.jsx)(k.Z,{type:"link",block:!0,onClick:function(C){var O;C==null||(O=C.stopPropagation)===null||O===void 0||O.call(C),e(!1),v.add(l.s9.After)},children:y[1]||"\u5728\u4E0B\u65B9\u63D2\u5165\u6761\u4EF6"},l.s9.After),h=(0,u.jsx)(k.Z,{type:"link",block:!0,onClick:function(C){var O;C==null||(O=C.stopPropagation)===null||O===void 0||O.call(C),e(!1),v.add(l.s9.Child)},children:y[2]||"\u63D2\u5165\u5B50\u7EA7\u6761\u4EF6"},l.s9.Child),U=a.depth>1&&(0,u.jsx)(k.Z,{type:"link",block:!0,onClick:function(C){var O;C==null||(O=C.stopPropagation)===null||O===void 0||O.call(C),e(!1),v.add(l.s9.BeforeParent)},children:y[3]||"\u5728\u7236\u7EA7\u4E0A\u65B9\u63D2\u5165\u6761\u4EF6"},l.s9.BeforeParent),q=a.depth>1&&(0,u.jsx)(k.Z,{type:"link",block:!0,onClick:function(C){var O;C==null||(O=C.stopPropagation)===null||O===void 0||O.call(C),e(!1),v.add(l.s9.AfterParent)},children:y[4]||"\u5728\u7236\u7EA7\u4E0B\u65B9\u63D2\u5165\u6761\u4EF6"},l.s9.AfterParent),M=[f,N,h,U,q].filter(function(nn){return!!nn}),b=(0,u.jsx)("div",{className:"".concat(o,"-action ").concat(o,"-action-addition"),children:(0,u.jsx)(yn.Z,{placement:"right",overlayClassName:"".concat(o,"-action-menu"),open:dn,onOpenChange:e,content:(0,u.jsx)("div",{className:"".concat(o,"-action-menu-container"),children:M}),trigger:"hover",getPopupContainer:t.getContainer,children:(0,u.jsx)(Cn.j,{})})},"addition"),cn=[s,b];if((0,W.m)(t==null?void 0:t.renderCondActions)){var Un=t.renderCondActions(cn,{node:g,data:(0,T.p)(g.data),actionClassName:"".concat(o,"-action")},v);return(0,u.jsx)("div",{className:"".concat(o,"-cond-actions"),children:Un})}return(0,u.jsx)("div",{className:"".concat(o,"-cond-actions"),children:cn})};return(0,u.jsxs)("div",{className:o,children:[B(),(0,u.jsx)("div",{className:"".concat(o,"-cond-field"),children:R()}),(0,u.jsx)("div",{className:"".concat(o,"-cond-operator"),children:m()}),(0,u.jsx)("div",{className:"".concat(o,"-cond-value"),children:E()}),c(),I()]})},pn=(0,Q.memo)(Bn),In=n(31759),Nn=n.n(In);function Mn(S){if(Nn()(S)!=="object"||S===null)return!1;for(var a=S;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(S)===a}var mn=function(){return"root"},Tn=function(a){return Mn(a)&&a.type==l.Jq.Group},vn=function(){return{key:"".concat(new Date().valueOf()),type:l.Jq.Item,description:"",data:{}}},Rn=function(){return{key:"".concat(new Date().valueOf()),type:l.Jq.Group,description:"",data:{relation:l.uT.AND},children:[]}},bn=mn(),tn=(0,z.t)("condition-group"),Pn=function S(a){var Z,o=(0,fn.E)(),an=(Z=o==null?void 0:o.disabled)!==null&&Z!==void 0?Z:!1,Y=(o==null?void 0:o.relationText)||["\u5E76\u4E14","\u6216\u8005"],dn=(0,Q.useRef)(null),e=a.value,G=a.onChange,t=!(e!=null&&e.children)||e.children.length<2,V=function(){var K=$()(i()().mark(function R(p,m,E){var B,c,v,I,r,s,f,N,h,U;return i()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(c=(0,T.p)(Object.assign({},e)),v=c==null||(B=c.children)===null||B===void 0?void 0:B.findIndex(function(b){return b.key==p}),!(v>-1)){M.next=26;break}if(!(a.parentNode&&[l.s9.BeforeParent,l.s9.AfterParent].includes(m))){M.next=7;break}m==l.s9.BeforeParent?(I=a.onAddParent)===null||I===void 0||I.call(a,e.key,l.s9.Before,E):(r=a.onAddParent)===null||r===void 0||r.call(a,e.key,l.s9.After,E),M.next=26;break;case 7:if(f=vn(),!(0,W.m)(o==null?void 0:o.onBeforeAddition)){M.next=22;break}return M.prev=9,M.next=12,o.onBeforeAddition(e,p,m);case 12:if(N=M.sent,N!==!1){M.next=15;break}return M.abrupt("return");case 15:f.data=N,M.next=22;break;case 18:return M.prev=18,M.t0=M.catch(9),console.warn("\u89E6\u53D1\u3010onBeforeAddition\u3011\u5F02\u5E38",M.t0),M.abrupt("return");case 22:E&&(f.data=E),m==l.s9.Before?c.children.splice(v,0,f):m==l.s9.After?c.children.splice(v+1,0,f):m==l.s9.BeforeParent?c.children.splice(v,0,f):m==l.s9.AfterParent?c.children.splice(v+1,0,f):(h=d()({},c.children[v]),U=Rn(),U.children.push(h,f),c.children.splice(v,1,U)),G(c),o==null||(s=o.onAddition)===null||s===void 0||s.call(o,e,p,m,f);case 26:case"end":return M.stop()}},R,null,[[9,18]])}));return function(p,m,E){return K.apply(this,arguments)}}(),y=function(){var K=$()(i()().mark(function R(p){var m,E,B,c,v;return i()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(E=(0,T.p)(Object.assign({},e)),B=E==null||(m=E.children)===null||m===void 0?void 0:m.findIndex(function(s){return s.key==p}),!(B>-1)){r.next=19;break}if(!(0,W.m)(o==null?void 0:o.onBeforeDelete)){r.next=16;break}return r.prev=4,r.next=7,o.onBeforeDelete(e,{key:p,index:B},l.Jq.Item);case 7:if(v=r.sent,v!==!1){r.next=10;break}return r.abrupt("return");case 10:r.next=16;break;case 12:return r.prev=12,r.t0=r.catch(4),console.warn("\u89E6\u53D1\u3010onBeforeDelete\u3011\u5F02\u5E38",r.t0),r.abrupt("return");case 16:E.children.splice(B,1),E.children.length==1&&E.key!==bn?G(d()(d()({},E.children[0]),{},{key:E.key})):G(E),o==null||(c=o.onDelete)===null||c===void 0||c.call(o,e,p,l.Jq.Item);case 19:case"end":return r.stop()}},R,null,[[4,12]])}));return function(p){return K.apply(this,arguments)}}(),g=function(R){var p,m=(0,T.p)(Object.assign({},e)),E=m==null||(p=m.children)===null||p===void 0?void 0:p.findIndex(function(B){return B.key==R.key});E>-1&&(m.children[E]=R,G(m))},rn=function(){var R;return e==null||(R=e.children)===null||R===void 0?void 0:R.map(function(p){return Tn(p)?(0,u.jsx)(S,{parentNode:e,value:p,onChange:g,onAddParent:function(E,B,c){V(E,B,c)},depth:a.depth+1},p.key):(0,u.jsx)(pn,{depth:a.depth+1,value:p,onChange:g,onAdd:V,onDelete:y},p.key)})},X=function(){var R,p,m;return t?null:(0,u.jsxs)("div",{className:"".concat(tn,"-relation-wrap"),children:[(0,u.jsx)("div",{className:"".concat(tn,"-line")}),(0,u.jsx)("div",{className:"".concat(tn,"-relation"),children:(0,u.jsx)(hn.Z,{getPopupContainer:o==null?void 0:o.getContainer,value:e==null||(R=e.data)===null||R===void 0?void 0:R.relation,onChange:function(B){var c=(0,T.p)(Object.assign({},e,{data:{relation:B}}));G(c)},disabled:an,style:{width:"100%",maxWidth:"100%"},options:[{value:l.uT.AND,label:(p=Y[0])!==null&&p!==void 0?p:"\u5E76\u4E14"},{value:l.uT.OR,label:(m=Y[1])!==null&&m!==void 0?m:"\u6216\u8005"}]})})]})};return(0,en.r)(a,(0,u.jsxs)("div",{className:jn()(tn,An()({},"".concat(tn,"-single"),t)),onChange:function(){},ref:dn,children:[X(),(0,u.jsx)("div",{className:"".concat(tn,"-content"),children:rn()})]}))},$n=["maxHeight","additionText","additionProps"],un=mn(),sn=(0,z.t)("condition-editor"),Wn=function(a){var Z=a.maxHeight,o=a.additionText,an=o===void 0?"\u6DFB\u52A0\u6761\u4EF6":o,Y=a.additionProps,dn=Y===void 0?{}:Y,e=J()(a,$n),G=(0,Q.useRef)(null),t=(0,En.R)({key:un,type:l.Jq.Group,data:{relation:l.uT.AND},children:[]},{defaultValue:e==null?void 0:e.defaultValue,value:e==null?void 0:e.value,onChange:e==null?void 0:e.onChange}),V=H()(t,2),y=V[0],g=V[1],rn=function(){var B=$()(i()().mark(function c(){var v,I,r,s,f;return i()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(I=l.s9.After,r=(0,T.p)(Object.assign({key:un,type:l.Jq.Group,data:{relation:l.uT.AND},children:[]},y)),s=vn(),!(0,W.m)(e==null?void 0:e.onBeforeAddition)){h.next=17;break}return h.prev=4,h.next=7,e.onBeforeAddition(y,un,I);case 7:if(f=h.sent,f!==!1){h.next=10;break}return h.abrupt("return");case 10:s.data=f,h.next=17;break;case 13:return h.prev=13,h.t0=h.catch(4),console.warn("\u89E6\u53D1\u3010onBeforeAddition\u3011\u5F02\u5E38",h.t0),h.abrupt("return");case 17:r.children.push(s),g(r),e==null||(v=e.onAddition)===null||v===void 0||v.call(e,y,un,I,s);case 20:case"end":return h.stop()}},c,null,[[4,13]])}));return function(){return B.apply(this,arguments)}}(),X=function(){var B=$()(i()().mark(function c(v,I,r){var s,f,N,h,U,q;return i()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(f=(0,T.p)(Object.assign({},y)),N=f==null||(s=f.children)===null||s===void 0?void 0:s.findIndex(function(cn){return cn.key==v}),!(N>-1)){b.next=22;break}if(U=vn(),!(0,W.m)(e==null?void 0:e.onBeforeAddition)){b.next=18;break}return b.prev=5,b.next=8,e.onBeforeAddition(y,v,I);case 8:if(q=b.sent,q!==!1){b.next=11;break}return b.abrupt("return");case 11:U.data=q,b.next=18;break;case 14:return b.prev=14,b.t0=b.catch(5),console.warn("\u89E6\u53D1\u3010onBeforeAddition\u3011\u5F02\u5E38",b.t0),b.abrupt("return");case 18:r&&(U.data=r),I==l.s9.Before?f.children.splice(N,0,U):I==l.s9.After&&f.children.splice(N+1,0,U),g(f),e==null||(h=e.onAddition)===null||h===void 0||h.call(e,y,v,I,U);case 22:case"end":return b.stop()}},c,null,[[5,14]])}));return function(v,I,r){return B.apply(this,arguments)}}(),K=function(){if(!(y!=null&&y.children)||(y==null?void 0:y.children.length)==0){if(e.disabled){var c;return(0,u.jsx)("div",{className:"".concat(sn,"-placeholder"),children:(c=e.noCondContent)!==null&&c!==void 0?c:"\u6CA1\u6709\u6761\u4EF6"})}return(0,u.jsx)("div",{className:"".concat(sn,"-addition"),children:(0,u.jsx)(k.Z,d()(d()({type:"dashed",block:!0},dn),{},{onClick:function(I){var r;(r=I.stopPropagation)===null||r===void 0||r.call(I),rn()},children:an}))})}return(0,u.jsx)(Pn,{depth:0,className:"".concat(sn,"-root"),value:y,onChange:g,onAddParent:function(I,r,s){X(I,r,s)}})},R=(0,Q.useCallback)(function(){return(e==null?void 0:e.getContainer)===!1?G.current:(0,W.m)(e==null?void 0:e.getContainer)?e.getContainer():(e==null?void 0:e.getContainer)||document.body},[G]),p=["disabled","relationText","levelText","renderCondField","renderCondOperator","operators","renderCondValue","renderCondPrefix","renderCondExtra","renderCondActions","onBeforeDelete","onBeforeAddition","onAddition","onDelete"],m=(0,w.C)(e,[].concat(p,["noCondContent","defaultValue","value","onChange","style","className","getContainer"])),E=(0,on.e)(e,p);return(0,u.jsx)(_.v.Provider,{value:d()(d()({},E),{},{getContainer:R}),children:(0,en.r)(e,(0,u.jsx)(gn.Z,d()(d()({ref:G,type:"inner",bordered:!1,bodyStyle:{maxHeight:Z}},m),{},{className:sn,children:K()})))})},Kn=ln(Wn,{Group:Pn,Item:pn})},87039:function(F,x,n){"use strict";n.d(x,{Jq:function(){return d},s9:function(){return j},uT:function(){return P}});var j=function(i){return i.Child="child",i.Before="before",i.After="after",i.BeforeParent="beforeParent",i.AfterParent="afterParent",i}({}),d=function(i){return i.Item="item",i.Group="group",i}({}),P=function(i){return i.AND="and",i.OR="or",i}({})},6085:function(F,x,n){"use strict";n.d(x,{v:function(){return d}});var j=n(59496),d=(0,j.createContext)({})},9983:function(F,x,n){"use strict";n.d(x,{E:function(){return P}});var j=n(6085),d=n(59496),P=function(){var D=(0,d.useContext)(j.v);return D}},93084:function(F,x,n){"use strict";n.d(x,{p:function(){return _},j:function(){return W}});var j=n(26068),d=n.n(j),P=n(67825),i=n.n(P),D=n(48763),$=n(17180),A=n(4637),H=["className","style"],L=1024,J=(0,D.t)("icon");function _(w){var on=w.className,en=w.style,k=i()(w,H);return(0,$.r)({className:on,style:en},(0,A.jsx)("span",{className:J,children:(0,A.jsx)("svg",d()(d()({color:"currentColor",fill:"currentColor",viewBox:"0 0 ".concat(L," ").concat(L),xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em"},k),{},{children:(0,A.jsx)("path",{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"})}))}))}var ln=["className","style"],T=1024,z=(0,D.t)("icon");function W(w){var on=w.className,en=w.style,k=i()(w,ln);return(0,$.r)({className:on,style:en},(0,A.jsx)("span",{className:z,children:(0,A.jsxs)("svg",d()(d()({color:"currentColor",fill:"currentColor",viewBox:"0 0 ".concat(T," ").concat(T),xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em"},k),{},{children:[(0,A.jsx)("path",{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8Z"}),(0,A.jsx)("path",{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8Z"})]}))}))}},43744:function(F,x,n){"use strict";n.r(x),n.d(x,{ConditionEditor:function(){return d.n},DeleteIcon:function(){return D.p},LevelType:function(){return P.s9},NodeType:function(){return P.Jq},PlusIcon:function(){return D.j},RelationType:function(){return P.uT},deepCopy:function(){return $.p},isFunction:function(){return A.m},omit:function(){return H.C},pick:function(){return L.e},useConditionEditor:function(){return i.E},withNativeProps:function(){return J.r}});var j=n(76e3),d=n(76643),P=n(87039),i=n(9983),D=n(93084),$=n(1787),A=n(68106),H=n(14413),L=n(11550),J=n(17180),_=n(73673),ln=n.n(_),T={};for(var z in _)["default","ConditionEditor","LevelType","NodeType","RelationType","useConditionEditor","deepCopy","isFunction","omit","pick","withNativeProps","DeleteIcon","PlusIcon"].indexOf(z)<0&&(T[z]=function(W){return _[W]}.bind(0,z));n.d(x,T)},1787:function(F,x,n){"use strict";n.d(x,{p:function(){return j}});var j=function(P){return JSON.parse(JSON.stringify(P))}},48763:function(F,x,n){"use strict";n.d(x,{t:function(){return j}});var j=function(P){return P?"ce-".concat(P):"ce"}},68106:function(F,x,n){"use strict";n.d(x,{m:function(){return j}});var j=function(P){return typeof P=="function"}},14413:function(F,x,n){"use strict";n.d(x,{C:function(){return j}});var j=function(P,i){return Object.keys(P).filter(function(D){return!(i!=null&&i.includes(D))}).reduce(function(D,$){return D[$]=P[$],D},{})}},11550:function(F,x,n){"use strict";n.d(x,{e:function(){return j}});var j=function(P,i){return Object.keys(P).filter(function(D){return i==null?void 0:i.includes(D)}).reduce(function(D,$){return D[$]=P[$],D},{})}},17180:function(F,x,n){"use strict";n.d(x,{r:function(){return $}});var j=n(26068),d=n.n(j),P=n(82187),i=n.n(P),D=n(59496);function $(A,H){var L=d()({},H.props);A.className&&(L.className=i()(H.props.className,A.className)),A.style&&(L.style=d()(d()({},L.style),A.style)),A.tabIndex!==void 0&&(L.tabIndex=A.tabIndex),A.id!==void 0&&(L.id=A.id);for(var J in A)A.hasOwnProperty(J)&&(J.startsWith("data-")||J.startsWith("aria-"))&&(L[J]=A[J]);return D.cloneElement(H,L)}},73673:function(){},76e3:function(){"use strict"}}]);
